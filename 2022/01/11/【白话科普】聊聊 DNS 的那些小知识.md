> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [www.appinn.com](https://www.appinn.com/upyun-dns/)

![](https://img3.appinn.net/images/202109/found-dns.jpg!o)

【白话科普】聊聊 DNS 的那些小知识

你是否在上网时，遇到过这样的情况：QQ 能正常发送消息，但是网页却打不开，查看网络连接又正常显示。面对这种情况很多小伙伴都感到有些无措。那究竟要怎么处理，这究竟是怎么回事呢？

上网查询得知，一般情况下电脑都是自动获取 DNS 服务器的，无需手动设置，但一些特殊情况下，没有获取到 DNS 服务器，或者服务器出现故障，那我们就需要手动更换 DNS 来保证正常访问网页。而这类无法显示的情况，恰好都是因为 DNS 配置错误导致的，可以通过修改 DNS 来解决。

那么 DNS 到底在哪里，它要如何修改呢？

**什么是 DNS**
-----------

DNS（Domain Name System）是域名系统的缩写。它是 Internet 的基础之一，用于将域名映射到 IP 地址，就像手机电话簿里将人的名字对应到电话号码一样。当我们在浏览器中输入 Web 地址时，就可以通过 DNS 查询将其转换为关联服务器对应的 IP 地址。如果没有 DNS，我们需要记住每个站点的 IP 地址才能访问它。

![](https://img3.appinn.net/images/202109/640-7.jpg)

这在互联网刚兴起时，还是可以比较轻松做到的，当时人们可以轻松地将特定 IP 地址与特定计算机相对应，通过在浏览器中直接输入特定的 IP 地址以访问网站。后来，随着越来越多的设备和人们加入到这个不断发展的网络，IP 越来越多，记忆就变成了一项极大的负担，网民都想要一个更易于记忆的单词组成的地址，因此诞生了域名。

在 70 年代和 80 年代初，这些名称和地址是由一个人（斯坦福大学的 Elizabeth Feinler）分配的，此人在名为 HOSTS.TXT 的文本文件中维护了所有与互联网连接的计算机的主列表。

显而易见随着 Internet 的发展，这是站不住脚的局面，越来越多的地址不可能由一个人维护。所以 1983 年，南加州大学的研究人员 Paul Mockapetris 因此开发了最初的域名系统，并命名为 DNS。尽管此后 DNS 发生了很大变化，但从根本上讲，它的工作方式仍与 40 年前一样。

在具体了解 DNS 在网络中的作用于工作原理前，我们先来看一下 DNS 的类别。

**DNS 服务器类别**
-------------

所有 DNS 服务器都属于以下四个类别之一：递归解析器、根域名服务器、TLD 域名服务器和权威性域名服务器。在典型的 DNS 查找中，这四种 DNS 服务器通过协同工作来完成将指定域的 IP 地址提供给客户端的任务。

### **DNS 递归解析器**

递归解析器（也称为 DNS 解析器）是 DNS 查询中的第一站。它属于客户端与 DNS 域名服务器的中间人。从 Web 客户端收到 DNS 查询的请求后，递归解析器将使用缓存的数据进行响应，或者向根域名服务器发送请求，接着向 TLD 域名服务器发送另一个请求，然后向权威性域名服务器发送最后一个请求。收到来自包含已请求 IP 地址的权威性域名服务器的响应后，递归解析器将向客户端发送响应。

在此过程中，递归解析器将缓存住从权威性域名服务器收到的信息。当一个客户端请求的域名 IP 地址是另一个客户端最近请求的 IP 地址时，解析器可绕过与域名服务器进行通信的过程，并从缓存中为客户端提供所请求的记录。

### **DNS 根域名服务器**

每个递归解析器都知道 13 个 DNS 根域名服务器，它们是递归解析器搜寻 DNS 记录的第一站。根服务器接受包含域名的递归解析器的查询，根域名服务器根据该域的扩展名（.com、.net、.org 等），通过将递归解析器定向到 TLD 域名服务器进行响应。根域名服务器由一家名为 Internet 名称与数字地址分配机构（ICANN）的非营利组织进行监督。

### **TLD 域名服务器**

顶级域名服务器（Top Level Domain）维护共享通用域扩展名的所有域名的信息，例如 .com、.net 等。例如，.com TLD 域名服务器包含以 “.com” 结尾的每个网站的信息。如果用户正在搜索 upyun.com，那么在收到来自根域名服务器的响应后，递归解析器将向 .com TLD 域名服务器发送查询，后者将通过针对该域的权威性域名服务器进行响应。

### **权威性域名服务器**

当递归解析器收到来自 TLD 域名服务器的响应时，该响应会将解析器定向到权威性域名服务器。权威性域名服务器通常是解析器查找 IP 地址过程中的最后一步。权威名称服务器包含特定域名的信息（例如，upyun.com），并且它可为递归解析器提供在 DNS A 记录中找到的服务器 IP 地址。或者如果该域具有 CNAME （别名）记录，它将为递归解析器提供一个别名域，这时递归解析器将必须执行全新的 DNS 查找，以便从权威性域名服务器获取记录（通常为包含 IP 地址的 A 记录）。

**DNS 记录**
----------

在权威性域名服务器中，DNS 记录是不可或缺的存在。

DNS 记录（又名区域文件）是位于权威 DNS 服务器中的指令，它提供了一个域的相关信息，包括哪些 IP 地址与该域关联，以及如何处理对该域的请求。此外，所有 DNS 记录都有一个 “TTL”，代表生存时间，指 DNS 服务器多久刷新一次该记录。

![](https://img3.appinn.net/static/wp-content/uploads/2021/09/640-1-2.jpg)

常见的 DNS 记录有以下几种：

*   A 记录：保存域的 IP 地址的记录。
*   CNAME 记录：别名，将一个域或子域转发到另一个域，不提供 IP 地址。
*   MX 记录：将邮件定向到电子邮件服务器。
*   TXT 记录：可使管理员在记录中存储文本注释。
*   NS 记录：存储 DNS 条目的名称服务器。
*   SOA 记录：存储域的管理信息。
*   SRV 记录：指定用于特定服务的端口。
*   PTR 记录：在反向查询中提供域名。

其中 A 记录和 CNAME 这两个是解析域名最常用的记录。

### **DNS A 记录**

“A”代表 “地址”，这是 DNS 记录的最基本类型，它指出了域的 IP 地址。例如，提取 upyun.com 的 DNS 记录，其“A” 记录目前会返回 IP 地址 115.231.97.2。“A”记录仅保存 IPv4 地址，如果站点具有 IPv6 地址，它将使用 “AAAA” 记录。

### **DNS CNAME 记录**

当域或子域是另一个域的别名时，使用 “规范名称” 记录代替 A 记录。假设 www.example.com 有一个 CNAME 记录，其值是“example.com”。这意味着，当 DNS 服务器访问 www.example.com 的 DNS 记录时，它实际上会触发对 example.com 的另一个 DNS 查找，返回 example.com 的 IP 地址。所有 CNAME 记录都必须指向一个域，而不是 IP 地址。

![](https://img3.appinn.net/static/wp-content/uploads/2021/09/640-2.png)

对于 CDN 来说，由于 CDN 中存在着遍布各地的节点，A 记录是完全不够用的。而节点又需要根据用户本地 DNS 所在地区和运营商不断变动。所以使用 CNAME 记录进行域名解析，是一个非常方便的管理方法。做了别名记录后，就不用再去管节点的 IP 怎么变化了。

**DNS 的工作方式** 
--------------

了解了 DNS 有几种，我们就可以来看一下 DNS 的工作方式了。

因为每一个上网设备都被分配了一个 IP 地址，所以当用户在 Web 浏览器中输入访问域名时，由客户端计算机发起请求，之后 DNS 在幕后通过一个名为 “DNS 解析” 的过程，查询对应服务器 IP，并进行连接。特别需要注意的是，如果你曾经访问过一次这个域名，那么你的本地会留有缓存，DNS 就会查找过程中会跳过一些步骤，从而使查找更快。

而完整的 DNS 查找则需要经历以下几个步骤：

*   以访问 “upyun.com” 为例，用户在浏览器中输入入 “upyun.com”，查询传输到 Internet 中，并被 DNS 递归解析器接收。
*   解析器查询 DNS 根域名服务器（.）。
*   根服务器使用存储其域信息的 TLD 域名服务器（.com）的地址响应该解析器。在搜索 upyun.com 时，我们的请求指向 .com TLD。
*   解析器向 .com TLD 发出请求。
*   TLD 服务器随后使用该域的域名服务器 upyun.com 的 IP 地址进行响应。
*   递归解析器将查询结果发送到域的域名服务器。
*   upyun.com 的 IP 地址之后从域名服务器返回解析器。
*   DNS 解析器使用最初请求的域的 IP 地址响应 Web 浏览器。

![](https://img3.appinn.net/static/wp-content/uploads/2021/09/640-3-1.jpg)

通过 DNS 查找的这几步返回 upyun.com 的 IP 地址后，浏览器便能发出对该网页的请求：

*   浏览器向该 IP 地址发起 HTTP 请求。
*   位于该 IP 的服务器返回网页到浏览器（第 10 步）。

看完了 DNS 的介绍，你是不是已经对 DNS 有所了解了呢，了解了 DNS，再遇到无法访问网页的情况，就可以通过修改 DNS 来解决了。是不是简单又方便呢？

**快 来 找 又 小 拍**
---------------

![](https://img3.appinn.net/static/wp-content/uploads/2021/07/640-1.jpg)

本文来自 [又拍云](https://www.upyun.com/) 微信公众号，作者 **小雪**。

#[白话科普](https://www.appinn.com/tag/%e7%99%bd%e8%af%9d%e7%a7%91%e6%99%ae/)前文回顾：

*   [【白话科普】网站图片不显示，背后的原因你都清楚吗？](https://www.appinn.com/website-images-not-displayed-upyun/)
*   [【白话科普】上网时遇到的 404 是什么意思？](https://www.appinn.com/what-does-404-mean-upyun/)