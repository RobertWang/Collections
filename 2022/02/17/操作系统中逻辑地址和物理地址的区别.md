> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s?__biz=MjM5NTY1MjY0MQ==&mid=2650838280&idx=2&sn=a499cb40ab4c768caf871f0dd4443a9f&chksm=bd0100468a768950193e0725a91c544e896484c4c1a920c1aec90d3950a84aa27cb5f3396999&mpshare=1&scene=1&srcid=0205e3JyYaoTF96SAg03y8nH&sharer_sharetime=1644055220319&sharer_shareid=7fece245937ac96f04f0fb8e1311fff1#rd)

来源 | 嵌入式应用研究院 （ID：gh_d6ff851b4069）

在对地址以及为什么需要它们进行了快速讨论之后，我们现在将区分逻辑地址和物理地址。

#### 1、逻辑地址简介

当我们谈论逻辑地址时，我们指的是 CPU 分配给每个进程的地址。正如我们已经讨论过的，一个进程在内存中所处的实际地址与进程认为它所处的地址是不一样的。这种地址映射基本上是在进程共享内存时所必需的，而不需要让进程知道它们彼此共享相同的内存空间。现在让我们来讨论逻辑地址。

每当 CPU 运行一个进程时，它都会为该进程分配一个特定的内存。下图简要说明了内存段在不同部分的划分，其中程序代码段位于低地址，栈位于高地址。

![](https://mmbiz.qpic.cn/mmbiz_jpg/SYiceJK78CIibaiayHziaRibQf5M0JgEbQ6NIOvELluZdUa6h7oG6ibX2rMMcz4Q7vz69vAlLcgNtgCibMNrLqK0x0VyA/640?wx_fmt=jpeg)

图 1.1：进程的内存空间

此分配的内存空间位于 CPU 为进程生成的虚拟地址（虚拟或逻辑地址），指示进程的代码、堆和堆栈部分将驻留的进程的内存空间。这个逻辑地址无疑与内存空间的实际地址不同。虚拟地址也称为指向主存储器中实际或物理地址的引用或指针。

大多数操作系统在其程序中都定义了基地址，在生成逻辑地址时，CPU 生成一个地址，程序将基地址与 CPU 生成的地址相加得到逻辑地址，即

**逻辑地址 = 基地址 + CPU 生成地址**

一个逻辑地址空间是指 CPU 产生的所有逻辑地址的集合。

#### 2、物理地址简介

物理地址是进程及其内容放置在主内存或硬盘中的地址。每当我们运行一个进程或将一些数据存储在计算机的主存储设备或辅助存储设备中时，我们总是将其存储起来以备将来随时访问。比如我在电脑的 D 盘存了一个 word 文件，我想访问它，以后怎么访问？当然是去 D 盘打开 word 文件。但是如果我将一个进程保存在主存中的某个存储单元或内存单元中，并希望将来访问它，该怎么办。就我们在本教程中研究过的地址而言，我们知道每当一个进程被创建时，CPU 都会生成它的虚拟地址，但又是一团糟。虚拟地址与进程实际放置在内存中的地址不同。

然而，内存单元存储在由物理地址（用户未知）访问的主内存中，我们所知道的只是进程的逻辑地址。那么当我们需要访问进程的时候我们将如何访问物理地址呢？到目前为止，这似乎是不可能的，但这当然不是因为我们从计算机诞生到现在一直在访问创建的进程。

因此，我们需要详细讨论这个问题。在进程创建时，CPU 不仅会生成虚拟地址，还会使用一些硬件支持将（先前生成的）虚拟地址映射到实际存储它的物理地址，这在下面的地址映射部分进行了讨论。因此，当我们尝试访问内存中已经保存的进程时，CPU 将虚拟地址返回给硬件，硬件将虚拟 / 逻辑地址映射到物理地址上，并间接访问进程的内存空间。

##### 2.1、地址映射

现在让我们讨论硬件如何在逻辑地址和物理地址之间执行映射。在 CPU 和内存管理单元 (MMU) 的硬件中安装有助于地址的映射。下图很好的解释了。

![](https://mmbiz.qpic.cn/mmbiz_png/SYiceJK78CIibaiayHziaRibQf5M0JgEbQ6NIERSsiaAOkv6Vialo7SHSmsvqaQBtWG4gsuWTL2e8KkPBwk2N2ickHWWfA/640?wx_fmt=png)

图 1.2：逻辑地址到物理地址的映射

这个内存管理单元对逻辑地址上的物理地址执行所有必需的映射。由 MMU 执行的非常基本的映射是由一种称为界限和基址的方案执行的。这是执行映射可以使用的最简单的方法。随着地址的映射变得越来越复杂，我们需要向内存管理单元添加越来越多的硬件。让我们讨论基址寄存器和界限寄存器。

##### 2.2、基址和界限法

![](https://mmbiz.qpic.cn/mmbiz_png/SYiceJK78CIibaiayHziaRibQf5M0JgEbQ6NIG3r0aLibKcWsoKKribiccxWgXONJRvpw2Vty0o64BK34qqb8vEvTZ73tw/640?wx_fmt=png)

图 1.3：基地址和边界地址的转换

在基于界限和基址的方法中，每个 MMU 单元都有两个寄存器，称为基址寄存器和界限寄存器。基址寄存器中包含特定进程（正在运行）的内存部分的起始地址。例如，当硬件需要取一些指令时，首先需要将基址寄存器的值与逻辑地址相加，得到物理地址。因此，基址寄存器与访问内存有关，另一方面，界限寄存器要么存储特定进程的内存部分的结束地址，要么还可能包含内存部分的总大小（包括代码、堆栈和堆）。它仅用于保护，以便进程不超过分配给它的内存区域，并且它可能不会跳入另一个进程的内存区域。下面给出了逻辑地址和物理地址的一般比较。  

[1] Yuvayana. (2020, August 13). What Is Memory Management Unit (MMU)? https://er.yuvayana.org/what-is-memory-management-unit-mmu/