> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s?__biz=MzU0NjgzMDIxMQ==&mid=2247599742&idx=2&sn=895c6b1b79ad0a5f9a34fb7c4a323124&chksm=fb54a492cc232d8417f7eacc9cf64bcfa2865e67a52143c46240966e1141872397aa5304dbfc&mpshare=1&scene=1&srcid=1023iysjDpwCwdZGYA3uifSN&sharer_sharetime=1666526451179&sharer_shareid=8a467675e94cd5b11b6640b7770d6cc6#rd)

重磅干货，第一时间送达

来自 | 知乎  作者 | 阿姆斯特朗

链接 | https://zhuanlan.zhihu.com/p/110026009

编辑 | 深度学习这件小事公众号

本文仅作学术交流，如有侵权，请联系后台删除

 **1. 回顾一下一维 FT**
-----------------

通俗来讲，一维傅里叶变换是将一个一维的信号分解成若干个复指数波 ![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31saSYWBaCiastVq5OHK4TvRVjdCDorQ7rqRhYicKvjiahxe6XuE9DtzrbfG0HyBAvDSMz/640?wx_fmt=svg) 。而由于 ![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31s1KJuBhNkylFoBLYMreQgziasibGa0xkdo0Z9XSFT03T4eojjhQaAtauCSspA638kWC/640?wx_fmt=svg) ，所以可以将每一个复指数波 ![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31saSYWBaCiastVq5OHK4TvRVjdCDorQ7rqRhYicKvjiahxe6XuE9DtzrbfG0HyBAvDSMz/640?wx_fmt=svg)都视为是余弦波 + j * 正弦波的组合。

对于一个正弦波而言，需要三个参数来确定它：频率 ![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31s7jlXZibfeSMw05oJLBFY4sfnwcnyDRh9chuQ2ibpc46ic5VVp7yOKnC0u5cEX1qtMZL/640?wx_fmt=svg) , 幅度 ![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31sFbPp1AicY67pzFEib4O1PFaFp8TDjl2Xw6RTUCVahFfsmnKFwpOTEOgbfouN9xenwV/640?wx_fmt=svg) ，相位 ![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31sYKAvfO20cSYABMBtlpeOus8jDiaxVUCgrK7ZRJhzHZIm008GfS9uOGFafPWuZOtE3/640?wx_fmt=svg) 。因此在频域中，一维坐标代表频率，而每个坐标对应的函数值也就是 ![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31sqnCcIEnGm09icLticriaN8mhk06XyQTYB8hvB2kkic2FTiacgLianDlpj4Ullyddl5xN0u/640?wx_fmt=svg) 是一个复数，其中它的幅度 ![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31sAOLAOjsicTD376s5cMPn64aQGcAWF4oCxMwGd5KAFeyzz99c050LnlIibk1LFFyEEv/640?wx_fmt=svg) 就是这个频率正弦波的幅度 ![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31sFbPp1AicY67pzFEib4O1PFaFp8TDjl2Xw6RTUCVahFfsmnKFwpOTEOgbfouN9xenwV/640?wx_fmt=svg) ，相位 ![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31sibwGBtLdGApZkiaeWAbxtDbelibL2CLlUeGFgbwzKicia7ygCW3RZm1icEAM9VSvULQjUY/640?wx_fmt=svg) 就是 ![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31sYKAvfO20cSYABMBtlpeOus8jDiaxVUCgrK7ZRJhzHZIm008GfS9uOGFafPWuZOtE3/640?wx_fmt=svg) 。下图右侧展现的只是幅度图，在信号处理中用到更多的也是幅度图。

![](https://mmbiz.qpic.cn/mmbiz_jpg/jXQJ6b7CBHpzRHqenBppCRCryToSPA9yCticL7JwQHDhONicS1J841FN82GDdHxxr3iasBdUsf3VlCRce3wVu9eZA/640?wx_fmt=jpeg)

一维傅里叶变换就是一个基变换，在时域中，基是一族冲激信号 ![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31siagqW4H19e8KsRaYqChQhLMrB7Ojw3pH6kMcVxNBHV8FdSFcfYvrhZibFz0haY3d2T/640?wx_fmt=svg) , 在频域中；基是 ![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31s6qTYPdrNNy1tg5evd9oleFpEmRypXk0nMcwHwzPGqvRrQMCCZ9xLKFXjb4LEWHp5/640?wx_fmt=svg) ，而且这组基是正交基。

![](https://mmbiz.qpic.cn/mmbiz_jpg/jXQJ6b7CBHpzRHqenBppCRCryToSPA9yINPLAFy064shiaQuMcj8NhShpiaicaInWA0k0rTmutk767ibU4iaDPoup5A/640?wx_fmt=jpeg)

F=Mf，基变换示意图

 **2. 类比：从一维到二维**
-----------------

一维信号是一个序列，FT 将其分解成若干个一维的简单函数之和。二维的信号可以说是一个图像，类比一维，那二维 FT 是不是将一个图像分解成若干个简单的图像呢？

确实是这样，二维 FT 将一个图像分解成若干个复平面波 ![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31sRmVp0EAQNg1uy9Tk1AEKj5SAicwyp7rhsd36tfCjmt8ic8Sqx717qwqAR0ibWygRTGM/640?wx_fmt=svg) 之和。如下图：

![](https://mmbiz.qpic.cn/mmbiz_jpg/jXQJ6b7CBHpzRHqenBppCRCryToSPA9ybicGJbq2HmWxUplxciayN0mnWjEFJOLNzhGm432fHNHUkXia4vCzetjzA/640?wx_fmt=jpeg)

二维 FT 的公式: ![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31sPLF8ibRohoibp3A0oRep0liaRd5A6R42CfJHICUJG8iafIWjAxnicxUxQpGBLnZqPJ0Iia/640?wx_fmt=svg)

通过公式，我们可以计算出，每个平面波在图像中成分是多少。从公式也可以看到，二维傅里叶变换就是将图像与每个不同频率的不同方向的复平面波做内积（先点乘在求和），也就是一个求在基 ![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31syQX7XB3vZ8XvaqSmvwibgQdhicYPZfjHcLwa94aehib75MCdkW9ysAY7xkVG0WAFAaG/640?wx_fmt=svg) 上的投影的过程。（应该知道 ![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31sHaJXX20VpDxPI59eOwia8o1Nk90tf9lS9Xmic4DFa2n95hTRHF9pbyzXzLDhPQTbHg/640?wx_fmt=svg) 是 b 在 a 上的投影，只不过这里的 | a | 的值被设为 1，所以只有内积）

 **3. 什么是二维频率域 K-SPACE**
------------------------

对于正弦平面波，可以这样理解，在一个方向上存在一个正弦函数，在法线方向上将其拉伸。前面说过三个参数可以确定一个一维的正弦波。哪几个参数可以确定一个二维的正弦平面波呢？答案是四个，其中三个和一维的情况一样（频率 ![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31s7jlXZibfeSMw05oJLBFY4sfnwcnyDRh9chuQ2ibpc46ic5VVp7yOKnC0u5cEX1qtMZL/640?wx_fmt=svg) , 幅度 ![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31sFbPp1AicY67pzFEib4O1PFaFp8TDjl2Xw6RTUCVahFfsmnKFwpOTEOgbfouN9xenwV/640?wx_fmt=svg) ，相位 ![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31sYKAvfO20cSYABMBtlpeOus8jDiaxVUCgrK7ZRJhzHZIm008GfS9uOGFafPWuZOtE3/640?wx_fmt=svg)），但是具有相同这些参数的平面波却可以有不同的方向 ![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31sQ2yUcmbUcMsTRKP7ZndjQoiam49vg08FkZxwmDicbib3Qoo5tPyMZEVr8quVn8RmuoJ/640?wx_fmt=svg) 。如下图所示：

![](https://mmbiz.qpic.cn/mmbiz_jpg/jXQJ6b7CBHpzRHqenBppCRCryToSPA9yVCtH6JTDMmyf9DYCTUJMpWBrFDG8E3hB98QT175JlYCBAE8IR1Vzew/640?wx_fmt=jpeg)

两个不同方向的平面波叠加

类比一维中，幅度和相位可以用一个复数表示，它可以作为我们存储的内容。但是还有两个：一个频率一个方向。这时想到向量是有方向的，也是有长度的。所以我们用一个二维的矩阵的来保存分解之后得到的信息。这个矩阵就是 K 空间。（一般用 k 来表示空间频率，单位是 1/m）

什么意思呢？就是说一个二维矩阵点 ![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31sVIDEtKh2pDlzHM14LZfkKY8Ciay8ibo2HFOcayUeFUIpQeycib3miaAHrS6wwpV6reVF/640?wx_fmt=svg) 代表这个平面波的法向量![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31sQ2yUcmbUcMsTRKP7ZndjQoiam49vg08FkZxwmDicbib3Qoo5tPyMZEVr8quVn8RmuoJ/640?wx_fmt=svg)，这个向量的模 ![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31sbp5BYNOCaK7pEPRjpPMtia822ZcEDUWWibhQHbNicq5aicibXQxucRibibvtu9kGmjiamw5g/640?wx_fmt=svg) 代表这个平面波的频率 ![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31s7jlXZibfeSMw05oJLBFY4sfnwcnyDRh9chuQ2ibpc46ic5VVp7yOKnC0u5cEX1qtMZL/640?wx_fmt=svg) ，这个点里面保存的内容复数就是此平面波的幅度和相位。下面这个图很好的体现了这一点：

![](https://mmbiz.qpic.cn/mmbiz_jpg/jXQJ6b7CBHpzRHqenBppCRCryToSPA9yrjL0qetDdG4jYcnKNo2gn3AUV4LyibB9ib9Sce9dDnZ3AibNg1XYfT14w/640?wx_fmt=jpeg)

也因此 K 空间的中心对于低频，周围对于高频。如下图，K 空间中只有（0，0）处有值，也就是信号都是直流即不存在变化，所以实空间就是一张白纸。

![](https://mmbiz.qpic.cn/mmbiz_jpg/jXQJ6b7CBHpzRHqenBppCRCryToSPA9ybg0WEhtvOnkiaGw4O8aQaaiaGYl8IsrT3nqX9Kpt4dxJHHo2ibuxWBDKA/640?wx_fmt=jpeg)

再如下面这个图片，中心低频贡献了图像的主体，周围高频提供图像的细节和边缘。

![](https://mmbiz.qpic.cn/mmbiz_jpg/jXQJ6b7CBHpzRHqenBppCRCryToSPA9y2u2MjRwJ26ibNBlrib9fwuBX9rxFibt3x0iaBiadk5ZK1BZzEasPMOS7Cuw/640?wx_fmt=jpeg)

因此，k 空间的每一个位置存储的数代表了所在位置复平面波在图像中占多少成分，我们就可以用每个系数 * 所代表的平面波相加得到原来的图像，也就是下图。所以 k 空间和对应图像储存的信息含量是一样的，只不过表现形式不同，或者说基不同。

![](https://mmbiz.qpic.cn/mmbiz_jpg/jXQJ6b7CBHpzRHqenBppCRCryToSPA9yhoPfbklxYxl5OXsCFwXfER3Xpia9NatLmT0QmsYnz3wLoIaPqiazKyAw/640?wx_fmt=jpeg)

 **4.K 空间的一些性质**
----------------

**离散的 2D-FT**

在数字图像中，数据都是离散的。也就涉及到采样的问题，和一维一样，如果采样率过低，k 空间就会混叠。同时在 k 空间中采样过低，图像也会混叠。

FOV 和分辨率在 k 空间和图像中是相反的关系。也就是：

![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31sRcy1uwvu6fLku9AibT6qyKNniaAswjzNK2cyLQoTR2GSROLhVu7NhUFc9dT3FlFOQw/640?wx_fmt=svg) ![](https://mmbiz.qpic.cn/mmbiz_svg/k947icPboBqCT45kSacxZiaNQxmBj4h31s7E22Ab60hA91amdYBtb94e0jsmD2TUpwGibmNGCxZG46L0h28BDLFMDXxQ9J7okc5/640?wx_fmt=svg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/jXQJ6b7CBHpzRHqenBppCRCryToSPA9yTYgG55XRUbibjd2BV5GVCelNQPT1qeEGHTLathOut8ia9iaV6K6ywnv9A/640?wx_fmt=jpeg)![](https://mmbiz.qpic.cn/mmbiz_jpg/jXQJ6b7CBHpzRHqenBppCRCryToSPA9yVf0KhwwO8H7BSrDiaHvHNHzib5XfCHYgy45zjGT04sB7vNicjquSIstAA/640?wx_fmt=jpeg)

减小 kmax，使得图像分辨率下降，减小Δk，使得 FOV 缩小。

**旋转不变性**

从平面波的角度很容易理解，旋转没有改变平面波的幅度相位，只是将所有的平面波都旋转了一个角度。下面这个图像显示了二维傅里叶变换中，实空间旋转多少，频率空间也会相应旋转多少。这其实是高维傅里叶变换缩放定理的一种特殊情况。（连续的是可以证明的，离散的涉及插值 ，不一定完全准确）

![](https://mmbiz.qpic.cn/mmbiz_jpg/jXQJ6b7CBHpzRHqenBppCRCryToSPA9yVjWOl7hybR4iakHKgmrpm9N1pqqQ9gQBWutFyVCvIibxLXRrYd5vHnSw/640?wx_fmt=jpeg)

 **5. 其他**
----------

1. 因为 matlab 中的 fft 算法都是将 0 放在第一个的，所有写 matlab 时一定要将 k 空间 fftshift 一下使得零频回到 k 空间中心。

2. 简单的应用 k 空间进行去噪例子。通过去掉明显的 k 空间的异常峰，可以去除图像中有规律变化的噪声或者伪影。

![](https://mmbiz.qpic.cn/mmbiz_jpg/jXQJ6b7CBHpzRHqenBppCRCryToSPA9yic9PXJPpbgozRt8GjnMF9CFhhdzO4RwgrD1TtUa1U64SBQfRLg9mGoQ/640?wx_fmt=jpeg)

指纹去噪

![](https://mmbiz.qpic.cn/mmbiz_jpg/jXQJ6b7CBHpzRHqenBppCRCryToSPA9yibNWVe7xV7RDq67DuyZ2OOXpdytPFzEjsIUyDzcqNBicpUyZO4JibatSg/640?wx_fmt=jpeg)

天体表面去噪

 **6、评论及解答**
------------

1、始终想不通为啥各个波的叠加能反应出某一个像素点的信号大小

你把它理解向量分解就懂了，平面波就是基，k 空间里的数就是基的系数。你得到系数（k 空间）的时候就是在投影，变为原向量（图像）就是叠加。只不过这里一个图像是一个向量而已。复平面波叠加时，先经过放大（幅度）在经过移位（相位），相位信息里保留了很多位置信息，可以查看我的另一个回答：

**为什么用图像二维傅里叶变换的相位谱进行反变换，能够大致得到原图的形状，而幅度谱则不行呢？**

https://www.zhihu.com/question/23718291/answer/1057562032

2、傅里叶变换后图像是关于频率矩形中心对称的，那么对称的 4 个平面三角波不就是注定了幅值和相角，频率是相等的。那么这样不是说明了任何波都是包含了 4 个这样对称的三角波，由它们组成？

是中心共轭对称，而没有左右上下的对称。而且只有实数图像的 k 空间才有这种特点，这是为了将复平面波中的虚部抵消掉，只留下实数部分。复数图像的 k 空间没有共轭对称的特点。下面是 k 空间的一部分数据，中心点为（101，101）。

![](https://mmbiz.qpic.cn/mmbiz_jpg/jXQJ6b7CBHpzRHqenBppCRCryToSPA9yTy8Q8ltZvaahv3vFlq7ukdOsib2V14FdPH2e07Yxmnd1GHicPshELbvQ/640?wx_fmt=jpeg)

  
参考：

[1] http://mriquestions.com

[2] A. Zisserman's lecture in B14 Image Analysis

链接：http://www.robots.ox.ac.uk/~az/lectures/ia/lect2.pdf

（这个 slides 真的不错，大家可以下载看看，里面也有其他的内容）