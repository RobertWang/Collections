> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/XUKO1rXwdaKS-2tFW0cqDg)

> 重构的魔力

大家好，我是渔夫子。

代码重构是在不改变外部功能的情况下对现有代码进行改进。它是编程的核心部分之一，不容忽视。否则，您就无法获得更好的代码版本。代码重构可以增强代码的**可读性**、**可维护性**和**可扩展性**。它还旨在提高**性能**和开发人员的**工作效率**。今天，我们将探讨一些可以帮助您更好地重构代码的技巧。

如何重构
----

在寻找重构的技术之前，让我们看看如何将代码重构集成到编码过程中。以下建议可用于此目的：

*   专门为重构代码分配时间。
    
*   将较大的重构问题分解为较小的问题进行管理。
    
*   试着让整个团队参与重构过程。
    
*   使用可以帮助您查找常见重构错误的自动化工具。
    

现在，让我们从用于重构的技术开始。

技术 1：提取方法
---------

此方法包括将代码块转换为单独的方法 / 函数。这样做是为了改进代码的结构和可读性。它是通过将长而复杂的代码块提取成更小、更易于管理的方法来实现的。要使用这种技术，我们首先需要找到一个复杂的特定任务的代码块。然后我们提取其中的代码并将其放入一个新的方法中。此外，请确保为该方法指定一个有**意义的名称**。

### 示例：

重构前：

```
function calculateInvoiceTotal(items) {
      let total = 0;
      for (let i = 0; i < items.length; i++) {
        const item = items[i];
        if (!item.quantity || !item.price) {
          console.error('Invalid item', item);
          continue;
        }
        const itemTotal = item.quantity * item.price;
        total += itemTotal;
      }
      return total;
    }


```

重构后：

```
function calculateInvoiceTotal(items) {
    let total = 0;
    for (let i = 0; i < items.length; i++) {
  const item = items[i];
        const itemTotal = calculateItemTotal(item);
        total += itemTotal;
    }
    return total;
}

function calculateItemTotal(item) {
 if (!item.quantity || !item.price) {
     console.error('Invalid item', item);
        return 0;
    }
    return item.quantity * item.price;
}


```

你看，我们把循环中计算商品总价格的代码提出成了一个单独的函数，第一个函数是不是变得简单而且易读了呢。

技术 2：用符号常量替代数字
--------------

这个技巧是为了编写更干净、可读性更强的代码。魔幻数是指硬编码的数值。写硬编码的数字会引起其他人的困惑，因为它们的目的没有定义。将硬编码的值转换为具有有意义名称的变量肯定会帮助其他人理解它。此外，您可以添加注释以进行进一步解释。它还可以帮助调试并降低将来出现错误的风险。

### 示例：

重构前：

```
if (temperature > 32) {
    // Do something if temperature is above freezing
}


```

重构后：

```
const int FREEZING_POINT = 32;

if (temperature > FREEZING_POINT) {
    // Do something if temperature is above freezing
}


```

技术 3：合并重复的代码
------------

重复或相同的代码可能出现在不同位置的代码中。这个代码不需要完全相同，但它可以执行类似的任务，或者从原始代码进一步扩展。重复的代码可能会导致几个问题：包括增加维护成本、难以更改代码库以及引入错误的更高风险。在重构代码时，您必须注意重复的代码。当找到这样的代码时，一种处理方法是将这样的代码转换为单个可重用的函数 / 方法。

### 示例：

重构前

```
 function calculateTotal(numbers) {
    let total = 0;
    for (let i = 0; i < numbers.length; i++) {
     total += numbers[i];
    }
    return total;
}

function calculateAverage(numbers) {
    let total = 0;
    for (let i = 0; i < numbers.length; i++) {
        total += numbers[i];
    }
    const average = total / numbers.length;
    return average;
}


```

重构后：

```
function calculateSum(numbers) {
    let total = 0;
    for (let i = 0; i < numbers.length; i++) {
     total += numbers[i];
    }
    return total;
}

function calculateTotal(numbers) {
    return calculateSum(numbers);
}

function calculateAverage(numbers) {
 const total = calculateSum(numbers);
    const average = total / numbers.length;
    return average;
}


```

在前面的代码示例中，我们进行求和，然后再次求平均值。重构后，我们将其替换为为两者提供和的函数。

结论
--

对于任何想要提高代码质量、性能和可维护性的开发人员来说，重构都是必不可少的实践。通过花时间分析和优化代码，您可以消除冗余，降低复杂性，并创建一个更高效、可扩展的应用程序。通过不断审查和改进代码，您可以创建一个更健壮、更有弹性的应用程序。我希望本文能帮助您理解一些重构技术。

原文参考链接：https://dev.to/documatic/5-code-refactoring-techniques-to-improve-your-code-2lia