> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s?__biz=MjM5NzU0MzU0Nw==&mid=2651408637&idx=4&sn=ff4bce200878929b839b1cf65a4c31ab&chksm=bd2583e98a520aff097a9eed042e74a149f977a4942d99175e57173d6cb146a9ef03189116e7&mpshare=1&scene=1&srcid=0912K92CRMdTTRfmu87s0DJR&sharer_sharetime=1662963133929&sharer_shareid=8a467675e94cd5b11b6640b7770d6cc6#rd)

> 作者：核子可乐、Tina  

“开发到死，永不停更。”  

如果要问有史以来最史诗般的计算机程序是什么，《矮人要塞》一定榜上有名。这是一款 2006 年面世的游戏，开创性地将 “先设定好基本规则，剩下的就让游戏和玩家自己去发掘” 的理念带到了电子游戏领域。《我的世界》开发者曾表示《矮人要塞》深刻启发了他的游戏设计思路。

整个游戏自始至终只有一名开发者：Tarn Adams，又名 Toady One。20 年来，他一直没有停止过开发。到目前为止，这款游戏的代码量已经多达 70 万行。

最近 Adams 在采访中分享了他对游戏创作以及如何管理一个不断增长的代码库的思考和经验。

**一套自然增长 20 年、从不重构的代码**

《矮人要塞》这款游戏由 Tarn Adams 及其兄弟 Zach 一起设计，其中 Adams 负责开发，Zach 负责剧情。Adams 原本是大学数学教授，最初只是将这款游戏当作一个副业进行，2002 年辞职开始全职开发，直到现在都没有停下过前进的脚步。

截至 2020 年 2 月，游戏最新更新为 0.47.05 版本。按照 Adams 设置的 “用进度代替版本号” 的命名规则，这个游戏目前完成度是 47%。Adams 表示，“现阶段，我们制定的计划很可能已经超出了我们的能力，需要花更长时间才能完成。”

这款作品支持三种不同游戏模式，包括堡垒建设模式，由玩家指挥一群矮人在荒地上建设一座城市；冒险模式，类似于传统的 roguelike 地下城探索游戏，收集充满中世纪韵味的武器、干掉危险的怪物；最后则是传奇模式，你可以观看由游戏本身精心整理出的传奇历史，回顾你操作过的每一位英雄人物、跨越几代人的史诗战争。这三种模式之间还会相互影响。当你的矮人定居点年久失修之后，就可以以冒险家的身份进行探索，将两种玩法的成果纳入同一个世界背景下的传奇当中。

另外，由于整个环境都是用 ASCII 字符的形式呈现，所以一切就变得更光怪陆离了。矮人用小小的笑脸表示，盔甲架对应一个音符，日元标志则代表着洞穴里的邪恶龙虾人。

![](https://mmbiz.qpic.cn/mmbiz_png/YriaiaJPb26VOdbia8XTaAyibCibjZ8CxkGOKrASibdsHh71lXG7eYBDTlaanGdhXIN45m3vS7IIG6CBkyKTxPSSjAfw/640?wx_fmt=png)

Adams 开发游戏使用的编程语言主要是 C 和 C++，开发工具此前是 Microsoft Visual Studio，现在改为 Visual Studio 社区版，用 OpenGL 和 SDL 作为游戏引擎。“只使用 Windows 10 Toshiba 笔记本电脑”，而且 “不确定 Linux/Mac 版本中发生了什么”。在游戏的机制方面，几乎不使用外部库，只偶尔会使用一些随机数生成器——“很久以前我放入了一个 Mersenne Twister，最近我采用了 SplitMix64。”

在游戏的最初版本中，Adams 就已经完成了所有编程工作，如今使用的代码库还是 2003 年构建的那套。整个游戏的后台需要一刻不停地疯狂运转，这也让《矮人要塞》这款其貌不扬的游戏成为有名的处理器 “杀手”。有人开玩笑说，用于娱乐目的的高性能处理器的最佳用途之一是《矮人要塞》。

初版游戏如今被称为《矮人要塞经典版》，通过 Bay 12 网站免费提供。对于各个版本，Adams 需要根据原始代码进行大约 12 次相应编译，包括面向不同平台的 32 位与 64 位操作系统版本。版本更新的间隔，最快的一次是 26 个月。

从开始到现在，项目几乎就没怎么经历过大的、严格意义上的重构，在 Adams 看来，花几个月重做某些数据结构就是他为项目所做的最大的改变。

而随着编码知识和技能不断更新换代，Adams 还得推动游戏的机制向前发展。与《我的世界》的 3D 界面比较起来，《矮人要塞》显得很古老。虽然现在的 3D 游戏开发已经很成熟了，但对于类似 Unity 或 Unreal 之类的库，Adams 表示就算到现在，他也不确定自己是否会使用。《矮人要塞》实现 3D 的方式只是通过添加 Z 坐标来完成。

历经 20 年的开发，这款游戏的代码库已经非常庞大，多达 711,000 行。靠人类的大脑，已经不可能完全记得住，就算这些全是 Adams 自己一行行实现的。

漫长的开发过程中面临的一个问题是遗忘。项目出了问题怎么进行维护，Adams 表示只能靠 “搜索”：“我有一个一致的命名方式，而且我不会吝啬更长的变量和函数名称，这样即使在多年之后，一切仍然可读。同时也需要留下足够的注释，来表示某个代码点发生了什么。一般来说，我会注意对未来的自己更友善。”

“这是个规模巨大的项目，我们没捷径可走……”

**这 20 年是如何度过的？**

《矮人要塞》是一款免费游戏。十几年以来，《矮人要塞》的开发者拒绝让这款游戏在任何平台发售。Adams 认为《矮人要塞》和市面上那些商业化的游戏都完全不同，这款游戏要以十年为单位一直更新、发展下去，他担心一旦商业化，会没法自己把握游戏更新的节奏。为此，两人拒绝了很多发行商的合作请求。

不上游戏平台销售游戏，自然就没有稳定的收入。Adams 这么多年全靠玩家捐赠维生，据他们所说每个月能有几千美元的捐款收入，足以维持生活和开发。通过 Bay 12 公司公司的官网页面，粉丝可以设置一次性或定期的 PayPal 捐赠。

![](https://mmbiz.qpic.cn/mmbiz_png/YriaiaJPb26VOdbia8XTaAyibCibjZ8CxkGOKicaxQnZ4Yj27WWhcRle3ARZSELXOibcsSl6TzOJXxMXw3hB3ro6cCznw/640?wx_fmt=png)

向 Bay 12 Games 捐款的粉丝们，有机会获得由 Tarn and Zach Adams 亲自用蜡笔绘制的手工艺作品。  

在 2006 年对外发布之前的几年里 Adams 是没有收入的， 各种花销完全靠当教授时积攒下来的 15,000 美元。2010 年，依靠粉丝捐赠，他总共挣到了 5 万美元。2014 年 11 月为 3,400 美元。2013 年 10 月为 4,727 美元。2014 年 12 月跃升至 8,181 美元。

Adams 将生活开支安排得很低，以满足他 “理想状态中的开发者生活”。每月只花费 860 美元的租金，几百美元的水电费和购买食物的费用，只要能自给自足就行。他对物质也没有什么要求，甚至在 2019 年才开始使用智能手机，在此之前，Adams 对自己的翻盖手机很满意。

根据《纽约时报》的记载，Adams 的开发生活是这样的：每天下午 3 点左右醒来，然后通宵编码，早上 6 点左右睡觉，周而复始。房间窗户用胶合板遮起来，阻挡阳光以免影响睡眠。

Adams 还在 2011 年拒绝了一家头部游戏开发商的工作邀请，以及另一家开发商 30 万美元的游戏许可报价，只希望用自己的方式开发自己的游戏。

这种理想主义的开发生活，让许多游戏玩家愤愤不平，但 Adams 却表示，“我们只是不想成为商人，赚钱对我们来说没有意义”。

**“开发到死，永不停更”**

过去 20 年当中，Adams 一直忙于为《矮人要塞》编程，甚至根本没有时间顾得上图形设计。为了最大程度削减图形设计带来的工作量，他甚至直接从已经三十岁高龄的 MS-DOS 中搬出了 ASCII 字符图像。

Adams 坦言，“有些菜单确实很粗糙，我在设计功能键时基本就是乱选的。所以很多玩家抱怨，「为什么得在这个界面里按 U、H、J、K 来实现对应功能？」好吧，有些设计已经是 15 年前的东西了，但出于种种原因我一直没来得及做出调整。”

由于游戏太过复杂，同时缺少现代游戏中常见的种种便利性设置，使得《矮人要塞》对新手玩家特别不友好。除了简短的介绍动画之外，游戏中没有任何图形元素，就连鼠标都不支持。新人在看着老鸟通过神秘的键盘输入控制界面时，感觉就像在观察上世纪八十年代初操盘手们使用的早期股票交易软件。

但所有这一切，让《矮人要塞》在游戏评论者及爱好者心中获得了独特的地位。它最近还被收录至纽约现代艺术博物馆中，改变了馆方对于艺术的审视方式。这款游戏的巨大影响力既体现在讲故事的方式上，也体现在对其他游戏开发者的启发上。如果没有《矮人要塞》，可能就不会有《我的世界》。

![](https://mmbiz.qpic.cn/mmbiz_png/YriaiaJPb26VOdbia8XTaAyibCibjZ8CxkGOK7k1vB9uX4riaXA3RAJduWvXjxibwcFv1mclQRZtcbibjImA8I3Aq4Iqgw/640?wx_fmt=png)

Steam 上的《矮人要塞》艺术展示图。

虽然《矮人要塞》的开发工作已经持续了相当长时间，但 Bay 12 给游戏打下的底子确实很好，后续更新一直相当顺利。Adams 会在社区内以博文的形式发布更新、讨论下一阶段的开发目标并说明自己在发布前如何进行代码测试。

几年前，他的兄弟 Zach 被诊断出患有癌症。虽然已经买了比较全面的医疗保险，但后期费用仍然不低。这时候的 Adams 重新审视自己的开发计划，突然被吓了一跳。“我们一起认真研究起治疗价格。如果换作是我，那我绝对会倾家荡产。”

出于对家族遗传性癌症的恐惧，且粉丝的捐赠并不足以帮他们消化掉美国重症医疗带来的沉重负担。Adams 这才做出了一个 “违背初心的决定”——在 2019 年正式启动游戏的商业化运营计划。这对他来说也是一种 “道德挑战”。但登陆 Steam 市场的确帮助他渡过了危机，Adams 总结道，“或者应该说是躲过了一劫。现在我们打算储备一点能应付紧急状况的资源，然后安心回到创作中来。”

目前他正在开发一个改进了 UI 的 Steam 付费版本。对于未来的开发计划，在将游戏打磨至完美之前，Adams 还有另外一项重要的更新任务得完成——在游戏里添加邪恶一派的非玩家角色。他以实事求是地态度向媒体讲述了开发目标，在记者看来他的想法只能用超现实来形容。

这些反派们将在更庞大的游戏世界中由 AI 负责控制。他们会有自己的动机，策划建立邪恶联盟或者逐步渗透政府。Adams 还强调，这些反派甚至能够囚禁英雄、暗杀国王。当然，反派们也会世代更迭，成为传奇模式中世界历史的一部分。最后，反派也将在要塞与冒险模式中闪亮登场，给玩家们制造或大或小的各种麻烦。

现在远远不是终点，《矮人要塞》还是希望更多玩家加入其中，为了牢牢抓住用户的心，Adams 需要花时间打磨这款作品。当然，Steam 版本的推出也让 Tarn Adams 和他的好兄弟 Zach Adams（兄弟二人创立了 Bay 12 Games 公司开展业务）实现了财务自由。所以只要他们的健康状况还允许，两位就会继续更新《矮人要塞》。

事实上，如果这样一款游戏宣布 “彻底完成”，对于粉丝们反而不是什么好消息。这款游戏的独特之处与核心吸引力，正在于极高的复杂性。它的游戏内容堪称包罗万象、无所不有。也正因为如此，当问到这款自 2003 年起就一直处于开发状态的游戏什么时候能最终完成时，Adams 给出的答案近乎疯狂：“完成代表着止步，止步代表着缺憾。”

在 Adams 看来，这条更新之路应该永远走下去：“开发到死，永不停更。”

--- EOF ---