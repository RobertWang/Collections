> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/Pz4HWwlWCiobaX14hOhKUQ)

> Nginx 实现限制 IP 访问以及防盗链等

前几天在群里看到有小伙伴咨询自己的博客服务器被境外 IP 撸了，有没有解决办法，因为资金有限没办法去买抗 D，这时有大佬就提出可以用 Nginx+GeoIP2 来实现！

  

  

于是我就翻阅了大量的文献，大致实现方法就是利用 Nginx 和 GeoIP2 模块配合国家 IP 数据库和城市 IP 数据库来实现。

  

  

  

根据官方文档介绍，GeoIP2 其实并不是官方的模块，而是别人开发的，所以如果需要安装这个模块的话，需要在编译的时候把这个模块引入到 Nginx 然后再编译，这个编译分两种，一种是动态编译一种是静态编译，动态编译的话，当你配置 Nginx 时需要在 nginx.conf 中添加

```
load_module modules/ngx_http_geoip2_module.so;

```

来加载 geoip2 的 so 文件，当你运行时会先加载这个文件然后再实现限制 IP 访问的目的，相反，静态的话，则不需要在配置中添加这个。  

  

  

而国家 IP 数据库和城市 IP 数据库是免费的，也有收费的，区别在于更新周期的长短，收费的更新周期会更短更频繁更精确。一般来说，免费的数据库已经足够了。

经过一番配置后，最终是可以实现禁止境外 IP 访问并且允许境内 IP 访问、防盗链、防爬虫、限制访问速度、限制连接数等功能的！  

  

**END**